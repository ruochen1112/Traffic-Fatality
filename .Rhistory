# a) List all the movies ( title & description ) that are rated PG-13 ?
SELECT
title,
description,
rating
FROM
film
WHERE
rating = 'PG-13';"
myData <- dbGetQuery(connection, myQuery)
myQuery <-
"
SELECT
title,
description,
rating
FROM
film
WHERE
rating = 'PG-13';"
myData <- dbGetQuery(connection, myQuery)
myQuery <-
" SELECT
title,
description,
rating
FROM
film
WHERE
rating = 'PG-13';"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT
*
FROM
film
WHERE
rating IN ('PG-13' , 'PG-13');"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT
title,
description,
rating
FROM
film
WHERE
rating IN ('PG-13' , 'PG-13');"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT
*
FROM
film
WHERE
rating IN ('PG-13' , 'PG-13');"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT
*
FROM
film
WHERE
rating IN ('PG' , 'PG-13');"
dbGetQuery(connection, myQuery);
dbListConnections(MySQL())
dbGetQuery(connection, "show processlist")
dbDisconnectAll <- function(){
ile <- length(dbListConnections(MySQL())  )
lapply( dbListConnections(MySQL()), function(x) dbDisconnect(x) )
cat(sprintf("%s connection(s) closed.\n", ile))
}
dbDisconnectAll();
myQuery <-
" SELECT
title,
description,
rating
FROM
film
WHERE
rating = 'PG-13';"
dbGetQuery(connection, myQuery);
install.packages("RMySQL")
library("RMySQL")
install.packages("RMySQL")
install.packages("RMySQL")
install.packages("RMySQL")
install.packages("RMySQL")
install.packages("RMySQL")
library("RMySQL")
unloadNamespace("RMySQL")
update.packages("RMySQL")
require(RMySQL)
install.packages("RMySQL")
install.packages("RMySQL")
install.packages("RMySQL")
unloadNamespace("RMySQL")
update.packages("RMySQL")
require(RMySQL)
connection = dbConnect(MySQL(),user="root", password="trytrytry1112",
dbname="sakila", host="localhost");
myQuery <- "
Select *
from actor;"
dbGetQuery(connection, myQuery)
myQuery <-
"
SELECT COUNT(*) FROM actor;"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT first_name,
last_name
FROM actor;"
dbGetQuery(connection, myQuery);
myQuery <-
" SELECT
title,
description,
rating
FROM
film
WHERE
rating = 'PG-13';"
dbGetQuery(connection, myQuery);
myQuery <-
"
SELECT
*
FROM
film
WHERE
rating IN ('PG' , 'PG-13');"
dbGetQuery(connection, myQuery);
dbListConnections(MySQL())
dbGetQuery(connection, "show processlist")
dbDisconnectAll <- function(){
ile <- length(dbListConnections(MySQL())  )
lapply( dbListConnections(MySQL()), function(x) dbDisconnect(x) )
cat(sprintf("%s connection(s) closed.\n", ile))
}
dbDisconnectAll();
import ggplot2
install.packages("rmarkdown")
intstall packages("tidyr")
install packages("tidyr")
install.packages("tidyr")
library(tidyr)
mtcars$mpg
mtcars[5,1:8]
install.packages("tidyrverse")
as_tibble(mtcars)
char <- c("a","b")
factr<- factor(char,levels =c("a","b"))
char
factr
install.packages("tidyrverse")
install.packages("tidyrverse")
install.packages("tidyrverse")
install.packages("readr")
install.packages("haven")
install.packages("dplyr")
install.packages("tidyr")
install.packages("stringr")
install.packages("ggplot2")
library(readr)
library(haven)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(dplyr)
library(dplyr)
acc2014 <- read_sas(accident.sas7bdat)
acc2015 <- read_csv(accident.csv)
acc2014 <- read_sas("accident.sas7bdat")
acc2015 <- read_csv("accident.csv")
getwd()
getwd()
setwd("/Users/ruochen/desktop/assignment-2-traffic-fatality-")
getwd()
acc2014 <- read_sas("accident.sas7bdat")
acc2015 <- read_csv("accident.csv")
acc2014
acc2015
ls()
class(acc2014)
class(acc2015)
mat <- matrix(c(1,2,3,4),2,2)
mat
class(mat)
test <- list(c(1,2), "cat", mtcars)
test
test[[1]]
mat[1,1]
mat
mat[1,2]
test[1]
class(mat)
class(acc2014)
class(acc2015)
vec <- c(1,2,3,4)
class(vec)
typeof(vec)
str(vec)
vec1 <- c("a","b")
class(vec1)
typeof(vec1)
str(vec1)
vec <- c(1,2,3,4,5)
typeof(vec)
vec <- c(1.2,2,3,4,5)
typeof(vec)
class(vec)
class(acc2014)
class(acc2015)
acc2014 %>% select(TWAY_ID2) %>% mutate(
na_if(TWAY_ID, "")
)
acc2014
acc2014 %>% select("TWAY_ID2") %>% mutate(
na_if(TWAY_ID, "")
)
acc2014 %>% select("TWAY_ID2")
acc2014 %>% as_tibble() %>% mutate(
TWAY_ID2 = na_if(TWAY_ID2, "")
)
table(is.na(acc2014$TWAY_ID2))
acc2014 <- acc2014 %>% as_tibble() %>% mutate(
TWAY_ID2 = na_if(TWAY_ID2, "")
)
table(is.na(acc2014$TWAY_ID2))
dim(acc2014)
dim(acc2015)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
colnames(acc2014)%in% colnames(acc2015)
dim(acc2014)
dim(acc2015)
colnames(acc2014)
colnames(acc2015)
colnames(acc2015) %in% colnames(acc2014)
colnames(acc2014) %in% colnames(acc2015)
acc <- bind_rows(acc2014, acc2015)
dim(acc)
colnames(acc)
head(acc)
count(acc, RUR_URB)
fips <- read_csv("fips.csv")
glimpse(fips)
head(fips)
?as.numeric()
acc$State <- as.character(as.numeric(acc$State))
acc$STATE <- as.character(as.numeric(acc$STATE))
acc$COUNTY <- as.character(as.numeric(acc$COUNTY))
head(acc)
?str_pad()
str_pad(acc$STATE, pad = "0")
str_pad(acc$STATE,1, pad = "0")
str_pad(acc$STATE,3, pad = "0")
str_pad(acc$STATE,2, pad = "0")
acc$COUNTY <- str_pad(acc$COUNTY, 3, pad = "0")
acc$STATE <- str_pad(acc$STATE, 2, pad = "0")
head(acc)
acc <- rename(acc, State = StateFIPSCode)
acc <- rename(acc, c("State" = "StateFIPSCode")
acc
head(acc)
acc <- rename(acc, c("State" = "StateFIPSCode")ï¼‰
acc <- rename(acc, c("State" = "StateFIPSCode"))
acc <- rename(acc, replace = c("State" = "StateFIPSCode"))
?rename()
acc <- rename(acc, "State" = "StateFIPSCode")
acc <- rename(acc, "StateFIPSCode" = "State")
acc <- rename(acc, "StateFIPSCode" = "STATE")
head(acc)
acc <- rename(acc, "CountyFIPSCode" = "COUNTY")
head(acc)
dim(acc)
?left_join()
acc %>% left_join(fips, by = "StateFIPSCode" & "CountyFIPSCode")
left_join(acc, fips, by = c("StateFIPSCode", "CountyFIPSCode"))
acc <- left_join(acc, fips, by = c("StateFIPSCode", "CountyFIPSCode"))
dim(acc)
acc$FATALS
agg <- acc %>% group_by(FATALS)
agg <- agg %>% summarise(TOTAL = sum(TOTAL))
agg
agg <- agg %>% summarise(TOTAL = TOTAL())
agg <- agg %>% summarise(TOTAL = n())
agg
agg <- acc %>% group_by(StateFIPSCode)
agg
agg <- acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = n(FATALS))
acc %>%
group_by(StateFIPSCode) %>%
summarise(FATALS, n())
acc %>%
group_by(StateFIPSCode) %>%
summarise(FATALS, TOTAL = n())
acc %>%
group_by(StateFIPSCode)
acc %>%
group_by(StateFIPSCode, FATALS) %>%
summarise(TOTAL = n())
acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = n())
acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS))
acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = count(FATALS))
acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = n(FATALS))
acc %>%
group_by(StateFIPSCode,FATALS) %>%
summarise(TOTAL = sum(FATALS))
acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS))
agg <- acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS))
agg
acc
unite_DF %>% spread(Quarter, Revenue)
agg %>% spread(YEAR, TOTAL)
acc$TOTAL <- acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS))
agg <- acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS)) %>% YEAR
agg <- acc %>%
group_by(StateFIPSCode) %>%
summarise(TOTAL = sum(FATALS)) %>% select(YEAR)
agg <- acc %>%
group_by(StateFIPSCode) %>%
select(YEAR)%>%
summarise(TOTAL = sum(FATALS))
agg <- acc %>%
group_by(StateFIPSCode) %>%
select(YEAR)%>%
agg <- acc %>%
group_by(StateFIPSCode) %>%
select(YEAR)
agg <- acc %>%
group_by(StateFIPSCode) %>%
select(YEAR)
agg
agg <- acc %>%
group_by(StateFIPSCode,FATALS,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg
agg %>% spread(YEAR, TOTAL)
agg <- acc %>%
group_by(StateFIPSCode,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg
agg %>% spread(YEAR, TOTAL)
acc
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg
agg_wide
agg_wide <- rename(agg_wide, "Year2014" = "`2014`", "Year2015" = "`2015`")
agg_wide <- rename(agg_wide, "Year2014" = "`2014", "Year2015" = "`2015")
agg_wide <- rename(agg_wide, "Year2014" = "'2014", "Year2015" = "'2015")
agg_wide <- rename(agg_wide, "Year2014" = "'2014'", "Year2015" = "'2015'")
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2014/Year2015+Year2014)X100)
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2014/Year2015+Year2014)*100)
agg_wide
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide
arrange(agg_wide, desc(Diff_Percent))
agg_wide %>%
filter(!is.na(StateName))
agg_wide %>%
filter(Diff_Percent>15%)
agg_wide %>%
filter(Diff_Percent > 0.1500000000000 )
agg_wide <- arrange(agg_wide, desc(Diff_Percent))
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
agg_wide <- agg_wide %>%
filter(Diff_Percent > 0.1500000000000 )
agg_wide
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide <- arrange(agg_wide, desc(Diff_Percent))
agg_wide
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
agg_wide
glimpse(agg_wide)
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide <- arrange(agg_wide, desc(Diff_Percent))
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
glimpse(agg_wide)
agg_wide <- agg_wide %>%
filter(Diff_Percent > 0.15 )
glimpse(agg_wide)
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide <- arrange(agg_wide, Diff_Percent)
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
glimpse(agg_wide)
agg_wide <- agg_wide %>%
filter(Diff_Percent > 0.15 )
glimpse(agg_wide)
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide <- arrange(agg_wide, Diff_Percent)
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
glimpse(agg_wide)
agg <- agg_wide %>%
filter(Diff_Percent > 0.15 )
glimpse(agg)
agg_wide <-agg %>% spread(YEAR, TOTAL)%>%
acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL)
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename("Year2014" = '2014', "Year2015" = '2015')
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename("Year2014" = '2014', "Year2015" = '2015')%>%
mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2)) %>%
arrange(Diff_Percent)
agg <- acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))
agg_wide <-agg %>% spread(YEAR, TOTAL)
agg_wide <- rename(agg_wide, "Year2014" = '2014', "Year2015" = '2015')
agg_wide <- agg_wide %>% mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2))
agg_wide <- arrange(agg_wide, Diff_Percent)
agg_wide <- agg_wide %>%
filter(!is.na(StateName))
agg <- agg_wide %>%
filter(Diff_Percent > 0.15 )
glimpse(agg)
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename("Year2014" = '2014', "Year2015" = '2015')%>%
mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2)) %>%
arrange(Diff_Percent) %>%
filter(!is.na(StateName))%>%
filter(Diff_Percent > 0.15 )
glimpse(agg)
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename("Year2014" = '2014', "Year2015" = '2015')%>%
mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2)) %>%
arrange(Diff_Percent) %>%
filter(!is.na(StateName))%>%
filter(Diff_Percent > 0.15 ) %>%glimpse
agg_wide <-acc %>%
group_by(StateName,YEAR) %>%
summarise(TOTAL = sum(FATALS))%>% spread(YEAR, TOTAL) %>%
rename("Year2014" = '2014', "Year2015" = '2015')%>%
mutate(Diff_Percent = (Year2015-Year2014)/((Year2014+Year2014)/2)) %>%
arrange(Diff_Percent) %>%
filter(!is.na(StateName))%>%
filter(Diff_Percent > 0.15 ) %>%glimpse
